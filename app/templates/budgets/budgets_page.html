{% extends "app/base.html" %}

{% block content %}
  {% csrf_token %}

  <div
    id="budgets-page"
    style="max-width: 1000px; margin: 0 auto; padding: 1rem 1rem 100px;"
  >
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
      <span></span>
      <wa-button hx-get="/budgets/new" hx-target="body" hx-swap="beforeend">
        <wa-icon slot="start" name="plus"></wa-icon>
        Add Budget
      </wa-button>
    </div>

    {% partialdef budget-list inline %}
      {% load currency %}

      <div id="budget-list">
        {% if budgets %}
          <table style="width: 100%; border-collapse: collapse;">
            <thead>
              <tr style="border-bottom: 2px solid #ddd;">
                <th style="text-align: left; padding: 0.75rem;">Category</th>
                <th style="text-align: right; padding: 0.75rem;">Budget Amount</th>
                <th style="text-align: right; padding: 0.75rem;">Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for budget in budgets %}
                {% partialdef budget-row inline %}
                  <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 0.75rem;">{{ budget.category.name }}</td>
                    <td style="padding: 0.75rem; text-align: right; font-weight: 500;">{{ budget.amount|currency }}</td>
                    <td style="padding: 0.75rem; text-align: right;">
                      <wa-button
                        size="small"
                        appearance="plain"
                        hx-get="/budgets/{{ budget.id }}"
                        hx-target="body"
                        hx-swap="beforeend"
                      >
                        <wa-icon name="pencil"></wa-icon>
                      </wa-button>
                      <wa-button
                        size="small"
                        appearance="plain"
                        hx-delete="/budgets/{{ budget.id }}"
                        hx-target="closest tr"
                        hx-swap="outerHTML"
                        hx-confirm="Are you sure you want to delete this budget?"
                      >
                        <wa-icon name="trash"></wa-icon>
                      </wa-button>
                    </td>
                  </tr>
                {% endpartialdef budget-row %}
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p style="text-align: center; padding: 2rem; color: #666;">
            No budgets set for this month. Click "Add Budget" to get started.
          </p>
        {% endif %}
      </div>
    {% endpartialdef budget-list %}
  </div>
{% endblock %}
