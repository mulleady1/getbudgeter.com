<sl-drawer
  label="Add New Bill"
  hx-on::load="setTimeout(() => this.show(), 100)"
  hx-on:sl-after-hide="this.remove()"
  hx-on::config-request="event.detail.headers['X-CSRFToken'] = this.querySelector('[name=csrfmiddlewaretoken]').value"
  hx-on::after-request="if (event.detail.successful) this.hide()"
>
  <form
    id="bill-form"
    {% if bill.id %}
      hx-put="{% url 'edit_delete_bill' bill.id %}"
    {% else %}
      hx-post="{% url 'bills' %}"
    {% endif %}
    hx-target="#bills-list"
    hx-swap="outerHTML"
    style="display: flex; flex-direction: column; gap: 1rem;"
  >
    {% csrf_token %}

    <sl-input name="name" label="Bill name" value="{{ bill.name }}" required style="width: 100%;"></sl-input>

    <sl-input
      type="number"
      name="amount"
      label="Amount"
      step="0.01"
      value="{{ bill.amount }}"
      required
      style="width: 100%;"
    ></sl-input>

    <sl-input
      type="url"
      name="link"
      label="Link (optional)"
      value="{{ bill.link|default:'' }}"
      style="width: 100%;"
    ></sl-input>

    <input type="hidden" name="month" label="Month" value="{{ bill.month|date:'Y-m' }}" required />
  </form>

  <div slot="footer" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
    <sl-button onclick="this.closest('sl-drawer').hide()" style="margin-top: 1rem; width: 100%;">Cancel</sl-button>
    <sl-button type="submit" variant="primary" form="bill-form" style="margin-top: 1rem; width: 100%;" app-spinner
      >Add Bill</sl-button
    >
  </div>
</sl-drawer>
