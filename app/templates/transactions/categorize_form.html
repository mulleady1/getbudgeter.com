{% csrf_token %}

<wa-dialog label="Categorize Transaction" style="--width: 500px;" open>
  <form
    hx-put="{% url 'edit_delete_transaction' transaction.id %}"
    hx-swap="outerHTML"
    hx-on::config-request="event.detail.headers['X-CSRFToken'] = document.querySelector('input[name=csrfmiddlewaretoken]').value"
  >
    <div style="margin-bottom: 1rem;">
      <p><strong>{{ transaction.description }}</strong></p>
      <p style="color: #666;">{{ transaction.date|date:"m/d/Y" }} - ${{ transaction.amount }}</p>
    </div>

    <div style="margin-bottom: 1rem;">
      <label for="category" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Category</label>
      <select name="category" id="category" required style="width: 100%; padding: 0.5rem;">
        <option value="">Select category...</option>
        {% for category in categories %}
          <option
            value="{{ category.id }}"
            {% if transaction.category_id == category.id %}selected{% endif %}
          >
            {{ category.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div style="display: flex; gap: 0.5rem; justify-content: flex-end; margin-top: 1.5rem;">
      <wa-button type="button" onclick="this.closest('wa-dialog').open = false" appearance="outlined">Cancel</wa-button>
      <wa-button type="submit">Save</wa-button>
    </div>
  </form>

  <script>
    document.querySelector('wa-dialog').addEventListener('wa-hide', function () {
      this.remove()
    })
  </script>
</wa-dialog>
